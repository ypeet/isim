<!DOCTYPE html>
<html>
<head>
  <title>Yulia T. Peet's Website</title>
  <style>
    body {
      display: flex;
      margin: 0;
      font-family: Arial, sans-serif;
    }
    nav {
      width: 200px;
      background-color: #f0f0f0;
      padding: 20px;
      box-sizing: border-box;
      height: 100vh;
    }
    main {
      padding: 20px;
      flex-grow: 1;
    }
  </style>
</head>
<body>
  <nav>
    <a href="/home" data-page="home.html">Home</a><br>
    <a href="/publications" data-page="publications.html">Publications</a><br>
    <a href="/research" data-page="research.html">Research</a><br>
  </nav>

  <main id="content">
    <!-- Content will load here -->
  </main>

  <script>
    async function loadPage(pageFile, urlPath, updateHistory = true) {
      console.log(`Loading ${pageFile}`);
      try {
        const res = await fetch(pageFile);
        if (!res.ok) throw new Error(`Failed to fetch ${pageFile}`);
        const html = await res.text();
        document.getElementById('content').innerHTML = html;
        if (updateHistory) {
          history.pushState({ pageFile }, '', urlPath);
        }
      } catch (err) {
        console.error(err);
        document.getElementById('content').innerHTML = `<h2>404 - Page not found</h2>`;
      }
    }

    // Handle clicks on navigation links
    document.querySelectorAll('nav a').forEach(link => {
      link.addEventListener('click', e => {
        e.preventDefault();
        const pageFile = link.getAttribute('data-page');
        const urlPath = link.getAttribute('href');
        loadPage(pageFile, urlPath);
      });
    });

    // Handle browser back/forward buttons
    window.addEventListener('popstate', e => {
      if (e.state && e.state.pageFile) {
        loadPage(e.state.pageFile, location.pathname, false);
      }
    });

    // Initial load: determine which page to show based on URL
    const pathToFile = {
      '/': 'home.html',
      '/home': 'home.html',
      '/publications': 'publications.html',
      '/research': 'research.html',
    };
    const initialPath = location.pathname;
    loadPage(pathToFile[initialPath] || 'home.html', initialPath, false);
  </script>
</body>
</html>
